
ejs 模版


## xss

### 反射型
用户输入的内容，由服务器直接构造页面返回，如果输入的内容是恶意脚本，就会触发脚本执行

### 持久型
用户输入的内容存储到服务器，服务器可能下发给大量用户

### DOM型
页面输入的内容直接在页面进行展示，从而导致的恶意脚本执行

### 预防方案
将用户输入的内容进行转义，将html文件进行转义，让其不再是有效的可执行html代码即可


## CSRF
用户登录了网站A

用户被诱导访问恶意网站B，网站B发出网站A的恶意请求

访问网站A时，浏览器会自动带上相应的cookie

### 验证HTTP Referee
HTTP头中的Referee字段用来标明请求来源于哪个地址。在处理敏感数据请求时，通常来说，Referee字段应该和请求地址位于同一域名下。

这种方法简单易行，仅需要在关键访问处增加一步校验，但该方法也有局限性，因其完全依赖浏览器发送正确的Referee字段。虽然HTTP协议对此字段的内容有明确的规定，但无法保证来访浏览器的具体实现。也无法保证浏览器没有安全漏洞影响到此字段。并且，也存在攻击者攻击浏览器篡改其Referee字段的可能性

### 在请求地址中添加Token并验证
CSRF的本质在于攻击者欺骗用户去访问自己设置的地址，所以如果在访问敏感数据请求时，要求用户浏览器提供不保存在cookie中并且攻击者无法伪造的数据作为校验，那么攻击者就无法在运行CSRF攻击，这种数据通常是窗体中的一个数据项。服务器将其生成并附加在窗体中，其内容是一个伪随机数。当客户端通过窗体提交请求时，这个伪随机数也一并提交上去以供校验，正常访问时客户端浏览器能够正确得到并传回这个伪随机数，而通过CSRF传来的欺骗性攻击中，攻击者事先无从得知这个伪随机数的值，服务端就会因为校验Token的值为空或者错误而拒绝这个可疑请求。
### 使用验证码

CSRF是在用户不知情的情况下构造了网络请求，因此添加验证码能强制用户必须与应用进行交互，服务器通过验证码来识别是不是用户主动发起的请求

